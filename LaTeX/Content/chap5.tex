We transition to treat the case of detection ambiguity. Specifically, we now allow for false alarms, the instance in which a detection is triggered when no target exists, and missed detections, the instance in which a target exists but no detection is generated. Consequently, the number of detections at each scan varies, and the number of targets we wish to track is now ambiguous. To state this explicitly, we introduce additional notation for the case of detection ambiguity. Let $n_{t}$ be the number of detections at scan \textit{t}. We denote 
\begin{align}
N_{0} = \underset{t}{\text{min }} n_{t}
\end{align}
as the largest number of detections across all scans, and similarly, we denote
\begin{align}
N_{1} = \underset{t}{\text{max }}  n_{t}
\end{align}
as the smallest number of detections across all scans. The only assumption we make in the case of detection ambiguity is that the true number of targets falls somewhere in the range of $[N_{0},N_{1}]$. Particularly, we replace Assumption~\ref{ass:basic_assumptions} with the following less restrictive assumption.
\begin{assumption}\label{ass:robust_assumptions}
\item The number of true targets $P$ satisfies $N_0\leq P \leq N_1$.
\end{assumption}

Several new challenges emerge in the case of detection ambiguity. First, we now need to estimate the number of targets. We denote the number of estimated targets as $P_{\text{estimated}}$ Second, in addition to assigning detections to a targets, we now have the alternate choice to classify detections as a false alarms \textit{i.e.}, each detection must either be assigned to a target or classified as a false alarm, but it cannot be both. Finally, we want to identify scans in which a missed detection has occurred for an estimated trajectory. In this section, we develop two approaches and models to solve these new challenges. The first approach eliminates the difficulty of the estimating the number of targets by assuming a fixed number of targets and using the power of parallelization in combination with the power of optimization to solves smaller, more tractable model. The second approach solves all of these elements simultaneously the optimization of a single MIO model. Though it is not tractable, we present it for completeness. 
 
\subsection{Fixed Number of Targets}
Although we do not know the number of targets, one approach is to formulate an MIO model that assumes a fixed number of targets $P$ and then use the power of parallelization to run that model with all possible values of $P$. Explicitly, we run these models for all values of $P$ that satisfy Assumption~\ref{ass:robust_assumptions}. After the models have been solved, we select the model that found the solution with the lowest overall objective value. The number of estimated targets $P_{\text{estimated}}$ is simply the value of $P$ corresponding to the winning model. With this methodology in mind, we now extend \eqref{eq:generalized_problem} to account for missed detections and false alarms. 

\subsubsection{Decision Variables}
Because we will assume a fixed number of targets $P$ for a given run of the the MIO, we only require two additional decision variables, one for identifying false alarms and another for identifying missed detections. Toward this goal, we introduce new binary decision variables $F_{it}$ to indicate whether or not a detection $x_{it}$ is a false alarm. 
\[F_{it} = 
\begin{cases}
1, & \text{if detection \textit{i} at time \textit{t} is a False Alarm,}\\
0, & \text{otherwise.}
\end{cases}\]
Likewise, we introduce binary decision variables $M_{jt}$ to indicate whether or not trajectory \textit{j} has a missed detection at time \textit{t}.
\[M_{jt} =
\begin{cases}
1, & \text{if detection for trajectory \textit{j}}\\
   &\text{at time \textit{t} is a Missed Detection,}\\
0, & \text{otherwise.}
\end{cases}\]

\subsubsection{Objective Function}
We can easily extend \eqref{eq:generalized_objective} to account for false alarms and missed detections by introducing penalties $\theta$ ($\phi$, respectively) for each missed detection (false alarm, respectively). This implies a linear penalty function, meaning that every missed detection (false alarm) is penalized exactly the same in equal increments. Therefore, we simply need to penalize the total number of false alarms and missed detections in the objective function. If we denote the total number of false alarms $TF$ and total number of missed detections $TM$, the resulting objective function takes the form:
\begin{align}
\underset{\psi_{jt}}{\text{minimize: }} & \sum_{j=1}^{P} \sum_{t=1}^{T} \psi_{jt} + \theta \cdot TF + \phi \cdot TM.
\end{align}
which can be linearized in the same manner as \eqref{eq:generalized_linear_objective}. As a general rule of them we would expect to increase $\theta$ ($\phi$, respectively) as the number of expected false alarms (missed detections, respectively) decreases. A more exhaustive discussion on the insight behind these penalties, in addition to recommendations for tuning them can be found in Appendix~\ref{\myabrv Penalty_Appendix}.

\subsubsection{Constraints}
Finally, we must restrict the set of feasible solutions to satisfy the assumptions made earlier. We accomplish this by simply modifying \eqref{eq:all_detections} and \eqref{eq:all_targets} to account for false alarms and missed detections, respectively. Specifically, all detections must either be assigned to a trajectory \textit{j} or to a false alarm:
\begin{align}\label{eqn: FA Simple}
\sum_{j=1}^{P} y_{itj} + F_{it} = 1 \qquad \forall i,t.
\end{align}
All trajectories \textit{j} must either be assigned a detection or a missed detection:
\begin{align}
\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j,t
\end{align}
Lastly, the sum of all false alarms must equal $TF$, and the sum of all missed detections must equal $TM$. 
\begin{align}
\sum_{i=1}^{n_{t}} \sum_{t=1}^{T} F_{it} = TF
\end{align}
\begin{align}\label{eqn: MD Total}
\sum_{j=1}^{P} \sum_{t=1}^{T} M_{jt} = TM 
\end{align}

\subsubsection{MIO with Fixed Number of Targets}
Merging all of these elements together we arrive at our MIO model for a scenario with detection ambiguity and a fixed number of targets. We refer to this model as the \textit{robust} MIO. 
\begin{align}
\underset{\psi_{jt}}{\text{minimize: }} & \sum_{j=1}^{P} \sum_{t=1}^{T} \psi_{jt} + \theta \cdot TF + \phi \cdot TM \label{eq:simple_robust}\\
\text{subject to: }	& \sum_{j=1}^{P} y_{itj} + F_{it} = 1 \qquad \forall i,t \nonumber \\
				& \sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j,t \nonumber\\
				& \sum_{i=1}^{n_{t}} \sum_{t=1}^{T} F_{it} = TF \nonumber \\
				& \sum_{j=1}^{P} \sum_{t=1}^{T} M_{jt} = TM \nonumber \\
				& x_{it}y_{itj} + M_{t}(1-y_{itj}) \geq z_{jt} \qquad \forall i,t,j \nonumber \\
				& x_{it}y_{itj} - M_{t}(1-y_{itj}) \leq z_{jt} \qquad \forall i,t,j \nonumber \\
				& z_{jt} - \alpha_{j} - \beta_{j}t \leq \psi_{jt} \qquad \forall j,t \nonumber \\
				& -(z_{jt} - \alpha_{j} - \beta_{j}t) \leq \psi_{jt} \qquad \forall j,t \nonumber \\
				& y_{itj} \in \{0,1\} \quad \forall i,t,j \nonumber \\
				& \alpha_{j} \in \mathbb{R}^n,\quad \beta_{j} \in \mathbb{R}^n \quad \forall j \nonumber\\
				& z_{jt} \in \mathbb{R}^n, \quad \forall j,t. \nonumber
\end{align}

\subsubsection{Heuristic with Fixed Number of Targets}
The heuristic for the scenario with ambiguity follows similarly from the heuristic developed under the scenario without ambiguity. Mainly, the heuristic initializes in the same manner and sweeps through all scans continuously making random swaps. However, the key difference in the newly adapted heuristic is that false alarms and missed detections must be included in the switches. Therefore, the framework of the new algorithm, also referred to as the \textit{robust} heuristic, is the same as the one presented in Figure~\ref{fig:Basic_Heuristic}, but the robust heuristic randomly chooses from the following options when making swaps: 
\begin{enumerate}
  \item Switch detection assignments between two existing targets.
  \item Switch the detection assignment of an existing target with a false alarm.
  \item Switch the detection assignment of an existing target with a missed detection for a different existing target.
  \item Move the detection assignment of an existing target to a false alarm and replace it with a missed detection.
  \item Move a false alarm into the location of a missed detection for an existing target.
\end{enumerate}

Similar to the basic heuristic, this robust extension will accept the switch/move if the objective score improves, and reject the switch/move otherwise, and terminates once it completes a full sweep without accepting a single swap. Due to the increase in potential combinations of solutions, we expect this variant of the heuristic to run slightly slower. Though this effect is mitigated by the fact that this variant is just as paralellizable as the basic heuristic. 

The MIO model and heuristic discussed here are extraordinarily powerful because they leverage both the powers of optimization and parallelization. Nevertheless, we take the time in the next section to present an alternate model, one that uses optimization alone to estimate the number of targets using a single model that cannot be parallelized. 

\subsection{Number of Targets as a Decision Variable}
For completeness we also present an MIO model that determines the number of targets via optimization by incorporating this element into the framework of the formulation, specifically through the introduction of decision variables. 

\subsubsection{Decision Variables}
Toward this goal, we introduce a new binary decision variable $w_{j}$ to indicate whether or not trajectory \textit{j} corresponds to an existing target.
\[w_{j} = 
\begin{cases}
1, & \text{if trajectory \textit{j} exists,}\\
0, & \text{otherwise.}
\end{cases}\]

\subsubsection{Constraints}
Most constraints remain similar to their original counterparts, except for slight adjust needed to account for the possibility that some trajectories may not exist. Explicitly, the number of possible trajectories is now $N_{1}$ so all instances of summing over \textit{j} must be changed accordingly. For example, we adjust \eqref{eq:} as follows: 
\begin{align}
\sum_{j=1}^{N_{1}} y_{itj} + F_{it} = 1 \qquad \forall i,t,\\
\sum_{j=1}^{N_{1}} \sum_{t=1}^{T} M_{jt} = TM.
\end{align}

All \textit{existing} trajectories must either be assigned a detection or a missed detection. 
\begin{align}\label{eqn: Existing Targets}
\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = w_{j} \qquad \forall j,t.
\end{align}

We restrict $\alpha_{j}$ and $\beta_{j}$ to be zero if trajectory \textit{j} does not exist. This ensures only existing trajectories are penalized in the objective function. 
\begin{align}
|\alpha_{j}|+|\beta_{j}| \leq M_{0}w_{j}\qquad \forall j.
\end{align}

Since $N_{0} \leq P \leq N_{1}$, we can set $w_j=1$ for all $j=1,\ldots,N_0$, which leaves us with only $N_1-N_0$ additional binary variables. We simply need the additional constraint
\begin{align}
w_{N_0+1}\geq ...\geq w_{N_1},
\end{align}
which reduces the symmetry of the formulation, and thus making it efficiently solvable. Furthermore, we can replace \eqref{eqn: Existing Targets} with the following two constraints:
\begin{align}
	\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j=1,...,N_{0},t\\
	\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = w_{j} \qquad \forall j=N_{0},...,N_{1},t.
\end{align}

\subsubsection{MIO with Number of Targets as a Decision Variable}
Incorporating these additional variables and constraints, we arrive at the following complete alternative formulation.
\begin{align}
\underset{\psi_{jt}}{\text{minimize: }} & \sum_{j=1}^{N_{1}} \sum_{t=1}^{T} \psi_{jt} + \theta \cdot TF + \phi \cdot TM\\
\text{subject to: }	& \sum_{j=1}^{N_{1}} y_{itj} + F_{it} = 1 \qquad \forall i,t \nonumber\\
				& \sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j=1,...,N_{0},t \nonumber \\
				& \sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = w_{j} \qquad \forall j=N_{0},...,N_{1},t \nonumber \\
				& \sum_{i=1}^{n_{t}} \sum_{t=1}^{T} F_{it} = TF \nonumber \\
				& \sum_{j=1}^{N_{1}} \sum_{t=1}^{T} M_{jt} = TM \nonumber \\
				& w_{N_0+1}\geq ...\geq w_{N_1} \nonumber \\
				& |\alpha_{j}|+|\beta_{j}| \leq M_{0}w_{j}\qquad \forall j \nonumber \\
				& x_{it}y_{itj} + M_{t}(1-y_{itj}) \geq z_{jt} \qquad \forall i,t,j \nonumber \\
				& x_{it}y_{itj} - M_{t}(1-y_{itj}) \leq z_{jt} \qquad \forall i,t,j \nonumber \\
				& z_{jt} - \alpha_{j} - \beta_{j}t \leq \psi_{jt} \qquad \forall j,t \nonumber \\
				& -(z_{jt} - \alpha_{j} - \beta_{j}t) \leq \psi_{jt} \qquad \forall j,t \nonumber \\
			 	& y_{itj} \in \{0,1\} \quad \forall i,t,j \nonumber \\
				& \alpha_{j} \in \mathbb{R}^n,\quad \beta_{j} \in \mathbb{R}^n,\quad w_{j} \in \mathbb{R}^n \quad \forall j \nonumber \\
				& z_{jt} \in \mathbb{R}^n, \quad \forall j,t. \nonumber
\end{align}

Next, we continue with approach to solving problems under detection ambiguity with a discussion on an extension to the heuristic outline in \mysection~\ref{\myabrv Heuristic}. 

\subsubsection{Heuristic with Number of Targets as a Decision Variable}

