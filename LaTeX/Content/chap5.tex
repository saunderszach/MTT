We now transition to treat the case of detection ambiguity. Specifically we now allow for false alarms, or the case where a detection is triggered when no target exists, and missed detections, or the case where a target exists but no detection is generated. As a result, the number of detections at each scan varies, and the number of targets we wish to track is now ambiguous. To state this more explicitly, we introduce additional notation for the case of detection ambiguity. Let $n_{t}$ be the number of detections at scan \textit{t}. We then denote 
\begin{align}
N_{0} = \underset{t}{\text{min }} n_{t}
\end{align}
as the largest number of detections across all scans, and similarly, we denote
\begin{align}
N_{1} = \underset{t}{\text{max }}  n_{t}
\end{align}
as the largest number of detections across all scans. Then the only assumption we will make for the case of detection ambiguity will be that the true number of targets falls somewhere within the range of the number detections. Specifically, we replace Assumption~\ref{ass:basic_assumptions} with the following less restrictive assumption.
\begin{assumption}\label{ass:robust_assumptions}
\item The number of true targets $P$ satisfies $N_0\leq P \leq N_1$.
\end{assumption}

Several new challenges emerge in the case of detection ambiguity. First, we now need to estimate the number of targets. Second, in addition to assigning detections to a targets, we now have the alternate choice to classify detections as a false alarm. More specifically, each detection must either be assigned to a target or classified as a false alarm, but it cannot be both. Finally, for each trajectory we want to identify scans in which a missed detection has occurred. Next, we outline an approach to combine the power of optimization with the power of parallelization to solve each element of this problem.
 
\subsection{Fixed Number of Targets}
Although we do not know the number of targets, one approach is to formulate an MIO model that assume a fixed number of targets and then use the power of parallelization to run that model with all possible numbers of targets. Explicitly, we can run these models with each fixed number of targets in the range of $N_{0}$ to $N_{1}$, as accorded by Assumption~\ref{ass:robust_assumptions}. Following completion of the solving process, we can select the model whose solution has the lowest overall objective value. The number of estimated target is simply the fixed number of targets in the winning model. With this methodology in mind, we now extend \eqref{eq:generalized_problem} to account for missed detections and false alarms. 

\subsubsection{Decision Variables}
The number of decisions needed to model the scenario reduces when we fix the number of targets. We only have two additional decisions to make from \eqref{eq:generalized_model} First, we need to either assign detections to trajectories or classify the detection as a false alarm. We already have decision variables $y_{itj}$ to handle assignments if the detection is to be assigned. To identify false alarms, we introduce new binary decision variables $F_{it}$ to indicate whether or not a detection $x_{it}$ is a false alarm. 
\[F_{it} = 
\begin{cases}
1, & \text{if detection \textit{i} at time \textit{t} is a False Alarm,}\\
0, & \text{otherwise.}
\end{cases}\]
Secondly, we introduce binary decision variables $M_{jt}$ to indicate whether or not an \textit{existing} trajectory \textit{j} has a missed detection at time \textit{t}.
\[M_{jt} =
\begin{cases}
1, & \text{if detection for trajectory \textit{j}}\\
   &\text{at time \textit{t} is a Missed Detection,}\\
0, & \text{otherwise.}
\end{cases}\]

\subsubsection{Constraints}
All detections must either be assigned to a trajectory \textit{j} or to a false alarm. 
\begin{align}\label{eqn: FA Simple}
\sum_{j=1}^{P} y_{itj} + F_{it} = 1 \qquad \forall i,t
\end{align}
All trajectories \textit{j} must either be assigned a detection or a missed detection. 
\begin{align}
\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j,t
\end{align}
The sum of all false alarms is TF, and similarly the sum of all missed detections is TM. 
\begin{align}
\sum_{i=1}^{n_{t}} \sum_{t=1}^{T} F_{it} = TF
\end{align}
\begin{align}\label{eqn: MD Total}
\sum_{j=1}^{P} \sum_{t=1}^{T} M_{jt} = TM 
\end{align}

\subsubsection{Objective Function}
We can easily extend \eqref{eq:generalized_objective} to account for false alarms and missed detections by introducing penalties $\theta$ ($\phi$, respectively) for each missed detection (false alarm, respectively). An objective function of this type would take the form of: 
\begin{align}
\underset{\psi_{jt}}{\text{minimize: }} & \sum_{j=1}^{P} \sum_{t=1}^{T} \psi_{jt} + \theta \cdot TF + \phi \cdot TM.
\end{align}
which can be linearized in the same manner as \eqref{eq:generalized_linear_objective}. A discussion on the insight behind these penalties, and recommendations for tuning them can be found in Appendix~\ref{\myabrv Penalty_Appendix}.

\subsubsection{Formulation 2}
\begin{align}
\underset{\psi_{jt}}{\text{minimize: }} & \sum_{j=1}^{P} \sum_{t=1}^{T} \psi_{jt} + \theta \cdot TF + \phi \cdot TM\\
\text{subject to: }	& \sum_{j=1}^{P} y_{itj} + F_{it} = 1 \qquad \forall i,t \nonumber \\
				& \sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j,t \nonumber\\
				& \sum_{i=1}^{n_{t}} \sum_{t=1}^{T} F_{it} = TF \nonumber \\
				& \sum_{j=1}^{P} \sum_{t=1}^{T} M_{jt} = TM \nonumber \\
				& x_{it}y_{itj} + M_{t}(1-y_{itj}) \geq z_{jt} \qquad \forall i,t,j \nonumber \\
				& x_{it}y_{itj} - M_{t}(1-y_{itj}) \leq z_{jt} \qquad \forall i,t,j \nonumber \\
				& z_{jt} - \alpha_{j} - \beta_{j}t \leq \psi_{jt} \qquad \forall j,t \nonumber \\
				& -(z_{jt} - \alpha_{j} - \beta_{j}t) \leq \psi_{jt} \qquad \forall j,t \nonumber \\
				& y_{itj} \in \{0,1\} \quad \forall i,t,j \nonumber \\
				& \alpha_{j} \in \mathbb{R}^n,\quad \beta_{j} \in \mathbb{R}^n \quad \forall j \nonumber\\
				& z_{jt} \in \mathbb{R}^n, \quad \forall j,t. \nonumber
\end{align}

\subsection{Number of Targets as a Decision Variable}
For completeness we also present an MIO model that incorporates the target estimation as a decision element within the formulation. In the previous section, we assumed we knew the number of targets. In this section, the number of targets is determined via optimization. 

\subsubsection{Decision Variables}
Toward this goal, we introduce a new binary decision variable $w_{j}$ to indicate whether or not trajectory \textit{j} corresponds to an existing target.
\[w_{j} = 
\begin{cases}
1, & \text{if trajectory \textit{j} exists,}\\
0, & \text{otherwise.}
\end{cases}\]

\subsubsection{Constraints}
Most constraints remain similar to their original counterparts, except now we must account for the possibility that some trajectories may not exist. Therefore, where before we summed over \textit{P}, we will now be summing over $N_{1}$. This affects two constraints.

All detections must either be assigned to a trajectory \textit{j} or to a false alarm. This can be implemented similarly to \eqref{eqn: FA Simple}, except now we sum over $N_{1}$ because the number of targets is unknown but limited by $N_{1}$.
\begin{align}
\sum_{j=1}^{N_{1}} y_{itj} + F_{it} = 1 \qquad \forall i,t.
\end{align}

Similarly, \eqref{eqn: MD Total} must be adjusted to sum over the maximal number of targets allowed $N_{1}$. 
\begin{align}
\sum_{j=1}^{N_{1}} \sum_{t=1}^{T} M_{jt} = TM.
\end{align}

All \textit{existing} trajectories must either be assigned a detection or a missed detection. 
\begin{align}\label{eqn: Existing Targets}
\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = w_{j} \qquad \forall j,t.
\end{align}

We restrict $\alpha_{j}$ and $\beta_{j}$ to be zero if trajectory \textit{j} does not exist. This ensures only existing trajectories are penalized in the objective function. 
\begin{align}
|\alpha_{j}|+|\beta_{j}| \leq M_{0}w_{j}\qquad \forall j.
\end{align}

Since $N_{0} \leq P \leq N_{1}$, we can set $w_j=1$ for all $j=1,\ldots,N_0$, which leaves us with only $N_1-N_0$ additional binary variables. We simply need the additional constraint
\begin{align}
w_{N_0+1}\geq ...\geq w_{N_1},
\end{align}
which reduces the symmetry of the formulation, and thus making it efficiently solvable. Furthermore, we can replace \eqref{eqn: Existing Targets} with the following two constraints:
\begin{align}
	\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j=1,...,N_{0},t\\
	\sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = w_{j} \qquad \forall j=N_{0},...,N_{1},t.
\end{align}

\subsubsection{Formulation 3}
Incorporating these additional variables and constraints, we arrive at the following complete alternative formulation.
\begin{align}
\underset{\psi_{jt}}{\text{minimize: }} & \sum_{j=1}^{N_{1}} \sum_{t=1}^{T} \psi_{jt} + \theta \cdot TF + \phi \cdot TM\\
\text{subject to: }	& \sum_{j=1}^{N_{1}} y_{itj} + F_{it} = 1 \qquad \forall i,t \nonumber\\
				& \sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = 1 \qquad \forall j=1,...,N_{0},t \nonumber \\
				& \sum_{i=1}^{n_{t}} y_{itj} + M_{jt} = w_{j} \qquad \forall j=N_{0},...,N_{1},t \nonumber \\
				& \sum_{i=1}^{n_{t}} \sum_{t=1}^{T} F_{it} = TF \nonumber \\
				& \sum_{j=1}^{N_{1}} \sum_{t=1}^{T} M_{jt} = TM \nonumber \\
				& w_{N_0+1}\geq ...\geq w_{N_1} \nonumber \\
				& |\alpha_{j}|+|\beta_{j}| \leq M_{0}w_{j}\qquad \forall j \nonumber \\
				& x_{it}y_{itj} + M_{t}(1-y_{itj}) \geq z_{jt} \qquad \forall i,t,j \nonumber \\
				& x_{it}y_{itj} - M_{t}(1-y_{itj}) \leq z_{jt} \qquad \forall i,t,j \nonumber \\
				& z_{jt} - \alpha_{j} - \beta_{j}t \leq \psi_{jt} \qquad \forall j,t \nonumber \\
				& -(z_{jt} - \alpha_{j} - \beta_{j}t) \leq \psi_{jt} \qquad \forall j,t \nonumber \\
			 	& y_{itj} \in \{0,1\} \quad \forall i,t,j \nonumber \\
				& \alpha_{j} \in \mathbb{R}^n,\quad \beta_{j} \in \mathbb{R}^n,\quad w_{j} \in \mathbb{R}^n \quad \forall j \nonumber \\
				& z_{jt} \in \mathbb{R}^n, \quad \forall j,t. \nonumber
\end{align}

\subsection{Robust Extension to Algorithm~\ref{alg:Basic_Heuristic}}
The heuristic for the scenario with ambiguity follows similarly from the heuristic developed under the scenario without ambiguity. The main difference is that now the options for making switches must include false alarms and missed detections. Therefore, the framework of the new algorithm is the same as for Algorithm~\ref{alg:Basic_Heuristic}, but the new variant of the heuristic randomly chooses from the following options: 
\begin{enumerate}
  \item Switch detection assignments between two existing targets.
  \item Switch the detection assignment of an existing target with a false alarm.
  \item Switch the detection assignment of an existing target with a missed detection for a different existing target.
  \item Move the detection assignment of an existing target to a false alarm and replace it with a missed detection.
  \item Move a false alarm into the location of a missed detection for an existing target.
\end{enumerate}

We refer to this robust extension to Algorithm~\ref{alg:Basic_Heuristic} as Algorithm 2. Similar to Algorithm~\ref{alg:Basic_Heuristic}, this robust extension will accept the switch/move if the objective score improves, and reject the switch/move otherwise. Algorithm 2 terminates under the same conditions as Algorithm~\ref{alg:Basic_Heuristic}. We expect Algorithm 2 to run slightly slower due to the increase in potential combinations of solutions. 